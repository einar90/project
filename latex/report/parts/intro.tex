% -*- root: ../project.tex -*-

\section{Introduction} % (fold)
\label{sec:introduction}
In reservoir simulation, a number of differential equations are used to describe the flow of fluids. Solving these equations analytically is only feasible for very simple systems involving homogeneous reservoirs with regular boundaries \cite{Peaceman1977Fundamentals}. Because of this, it is necessary to create discrete models for the reservoirs we want to model, and solve the flow equations numerically.

For simplicity, this project is restricted to cases dealing with single-phase, two-dimensional, steady-state flow under isotropic conditions.

\subsection{Numerical reservoir simulation} % (fold)
\label{sub:numerical_reservoir_simulation}


The reservoir is discretized by dividing it into \emph{grid blocks}. Each block is associated with a set of properties (porosity, permeability, saturations etc.) approximating the properties in the corresponding area of the original reservoir; this is illustrated in Figure~\ref{fig:grid-discretization}. This discretization allows us to calculate the flow within the model using a set of easily solved equations, each of which describe the state of each block, including the flow into- or out of it, at some point in time.

\begin{figure}[htbp]
    \centering
    \includegraphics[]{figures/grids/3d_grid_4x3x2.pdf}
    \caption{Illustration of a continuous reservoir and a $4\times 4\times 2$ discretization of it. In the continuous reservoir, the properties are continuous functions in the spatial dimensions; in the discretized reservoir, each block has a set of properties that does not vary within the it, approximating the properties in the corresponding area of the continuous reservoir.}
    \label{fig:grid-discretization}
\end{figure}


Wells in a numerical reservoir simulation model are placed inside grid blocks, often called \emph{well blocks}. The horizontal dimension of a well block may be hundreds of meters\footnote{This may be remedied by using local grid refinement (LGR) around the well.}, \emph{much} larger than the well-bore radius. This means that the pressure calculated for the well block will differ greatly from the bottom-hole pressure of the well. This pressure difference is important, because it is needed to calculate the fluid flow  from the well block into the well-bore.

\subsubsection{Well index (WI)} % (fold)
\label{ssub:well_index_}

The relationship between the well-bore and the rest of the reservoir is modeled through the use of a \emph{well index} (WI)\footnote{The term ``connection transmissibility factor'' (CF) is also used by some authors\cite{Peaceman2003New,Schlumberger2013Eclipse}.}. The well index relates the well flow rate into or out of any grid block intersected by a well to the difference between the well block pressure $p_{wb}$ and the local flowing well-bore pressure $p_{wf}$ \cite{Wolfsteiner2003Calculation}. For single phase flow this relationship is
\begin{equation}
    \label{eq:wolfsteiner-well-index-multiple-blocks}
    q = \frac{WI}{\mu} \left( p_{wb} - p_{wf} \right)
\end{equation}
where $q$ is the volumetric flow rate.

The well index accounts for the geometry of the well block, location and orientation of the well segment in the grid block, and rock properties. For a single vertical well in a 2D areal reservoir \cite{Peaceman2003New},
\begin{equation}
    \label{eq:well-index-intro}
    WI = \frac{2\pi kh}{\ln \left(r_{eq}/r_{w}\right)}
\end{equation}
where $r_{eq}$ is the \emph{equivalent well-bore radius} and $r_w$ is the well-bore radius.

The user can often define the values of $WI$ or $r_{eq}$ for each well block in commercial simulators, or the simulator cal calculate it using a default expression \cite{Peaceman2003New}.
% subsubsection well_index_ (end)

\subsubsection{Equivalent well-bore radius} % (fold)
\label{ssub:equivalent_well-bore_radius}
The equivalent well-bore radius, $r_{eq}$, is the radius at which the steady-state flowing pressure for the actual well is equal to the numerically calculated pressure for the well block. Examination of the pressures obtained by numerical solution of single-phase flow into a single well at steady state shows that $r_{eq} \approx 0.2 \Delta x$; i.e. that the well block pressure is approximately equal to the actual flowing pressure calculated using the radial flow equation \cite{Dake1978Developments}
\begin{equation}
    p = p_{wf} + \frac{q\mu}{2\pi kh} \ln{\frac{r}{r_w}}
\end{equation}
 at a radius of $0.2 \Delta x$ \cite{Peaceman1978Interpretation}.
% subsubsection equivalent_well-bore_radius (end)

\subsubsection{ECL100 implementation} % (fold)
\label{ssub:ecl100_implementation}
Schlumberger's ECL100 reservoir simulator uses the following default relationship to calculate the well index:
\begin{equation}
    WI = \frac{c\theta k h}{\ln \left(r_{eq}/r_w\right)+S}
\end{equation}
where $c$ is a unit conversion factor; $\theta$ is the angle of the segment connecting the well in radians ($2\pi$ for a Cartesian grid); and $S$ is the skin factor \cite{Schlumberger2013Eclipse}. For dimensionless units in a Cartesian grid and no skin effect, it reduces to equation \eqref{eq:well-index-intro}.
\nomenclature{$c$}{unit conversion factor}
\nomenclature{$\theta$}{angle of segment connecting the well}
\nomenclature{$S$}{skin factor}

The equivalent well-bore radius is by default calculated using the following expression:
\begin{equation}
    r_{eq} = 0.28 \frac{\sqrt{\Delta x^2 \sqrt{k_y/k_x} + \Delta y^2 \sqrt{k_x/k_y}}}{\sqrt[4]{k_y/k_x}+\sqrt[4]{k_x/k_y}}
\end{equation}
which for isotropic conditions $k_x=k_y$ on a square grid $\Delta x= \Delta y$ reduces to
\begin{equation}
    r_{eq} = 0.1980 \Delta x
\end{equation}
% subsubsection ecl100_implementation (end)

% subsection numerical_reservoir_simulation (end)

% section introduction (end)
