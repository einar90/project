% -*- root: ../project.tex -*-

\section{Introduction} % (fold)
\label{sec:introduction}
In reservoir simulation, a number of differential equations are used to describe the flow of fluids. Solving these equations analytically is only feasible for very simple systems involving homogeneous reservoirs with regular boundaries \cite{Peaceman1977Fundamentals}. Because of this, it is necessary to create discrete models for the reservoirs we want to model, and solve the flow equations numerically.

For simplicity, this project is restricted to cases concerning single-phase, two-dimensional, steady-state flow under isotropic conditions.

\subsection{Numerical reservoir simulation} % (fold)
\label{sub:numerical_reservoir_simulation}


The reservoir is discretized by dividing it into \emph{grid blocks}. Each block is associated with a set of properties (porosity, permeability, saturations etc.) approximating the properties in the corresponding area of the original reservoir; this is illustrated in Figure~\ref{fig:grid-discretization}. This discretization allows us to calculate the flow within the model using a set of easily solved equations, each of which describe the state of each block, including the flow into- or out of it, at some point in time.

\begin{figure}[htbp]
    \centering
    \includegraphics[]{figures/grids/3d_grid_4x3x2.pdf}
    \caption{Illustration of a continuous reservoir and a $4\times 4\times 2$ discretization of it. In the continuous reservoir, the properties are continuous functions in the spatial dimensions; in the discretized reservoir, each block has a set of properties that does not vary within the it, approximating the properties in the corresponding area of the continuous reservoir.}
    \label{fig:grid-discretization}
\end{figure}


Wells in a numerical reservoir simulation model are placed inside grid blocks, often called \emph{well blocks}. The horizontal dimension of a well block may be hundreds of meters\footnote{This may be remedied by using local grid refinement (LGR) around the well.}, \emph{much} larger than the wellbore radius. This means that the pressure calculated for the well block will differ greatly from the bottom-hole pressure of the well. This pressure difference is important, because it is needed to calculate the fluid flow  from the well block into the wellbore.

\subsection{Well Models} % (fold)
\label{sub:well_models}
In numerical reservoir simulation, well models are used to relate the wellblock pressure to the actual wellbore pressure. The most commonly used model is Peaceman's model, utilizing the concept of an ``equivalent wellbore radius'', $r_{eq}$. This model may be stated as
\begin{equation}
    \label{eq:intro-well-model}
    p_{wb} = p_{wf} + \frac{q\mu}{2\pi k h} \ln \frac{r_{eq}}{r_{w}}
\end{equation}
where $p_{wb}$ is the wellblock pressure and $p_{wf}$ is the flowing wellbore pressure \cite{Peaceman1990Interpretation}.
% subsection well_models (end)

\subsubsection{Well Index (WI)} % (fold)
\label{ssub:well_index_}
The components of Peaceman's well model accounting the geometry of the well block, location and orientation of the well segment within the well block and rock properties have been used by several authors (although not Peaceman himself) to define a \emph{well index}\footnote{The term ``connection transmissibility factor'' (CF) is also used by some authors\cite{Peaceman2003New,Schlumberger2013Eclipse}.} \cite{Wolfsteiner2003Calculation}:
\begin{equation}
    \label{eq:well-index-intro}
    WI = \frac{2\pi kh}{\ln \left(r_{eq}/r_{w}\right)}
\end{equation}
Substituting equation \eqref{eq:well-index-intro} into equation \eqref{eq:intro-well-model} and solving for the flow rate, $q$, yields the expression commonly used to calculate the flow rate from a well block into the well:
\begin{equation}
    \label{eq:wolfsteiner-well-index-multiple-blocks}
    q = \frac{WI}{\mu} \left( p_{wb} - p_{wf} \right)
\end{equation}

The user can often define the values of $WI$ or $r_{eq}$ for each well block in commercial simulators, or let the simulator calculate it using a default expression \cite{Peaceman2003New}.
% subsubsection well_index_ (end)

\subsubsection{Equivalent wellbore radius} % (fold)
\label{ssub:equivalent_wellbore_radius}
The equivalent wellbore radius, $r_{eq}$, used in Peaceman's well model, is the radius at which the steady-state flowing pressure for the actual well is equal to the numerically calculated pressure for the well block. Examination of the pressures obtained by numerical solution of single-phase flow into a single well at steady state shows that $r_{eq} \approx 0.2 \Delta x$; i.e. that the well block pressure is approximately equal to the actual flowing pressure calculated using the radial flow equation \cite{Dake1978Developments}
\begin{equation}
    p = p_{wf} + \frac{q\mu}{2\pi kh} \ln{\frac{r}{r_w}}
\end{equation}
 at a radius $r = 0.2 \Delta x$ \cite{Peaceman1978Interpretation}.
% subsubsection equivalent_wellbore_radius (end)

\subsubsection{ECL100 and MRST implementation} % (fold)
\label{ssub:ecl100_implementation}
Schlumberger's ECL100 reservoir simulator uses the following default relationship to calculate the well index:
\begin{equation}
    \label{eq:wi_ecl}
    WI = \frac{c\theta K h}{\ln \left(r_{eq}/r_w\right)+S}
\end{equation}
where $c$ is a unit conversion factor; $\theta$ is the angle of the segment connecting the well in radians ($2\pi$ for a Cartesian grid); $K$ is the geometric mean of the permeabilities in $x$- and $y$-directions, $K=\sqrt{k_x k_y}$;and $S$ is the skin factor \cite{Schlumberger2013Eclipse}. For dimensionless units in a Cartesian grid and no skin effect, it reduces to equation \eqref{eq:well-index-intro}.
\nomenclature{$c$}{unit conversion factor}
\nomenclature{$\theta$}{angle of segment connecting the well}
\nomenclature{$S$}{skin factor}

The expression MRST uses to calculate the well index is not stated explicitly in the manual \cite{Lie2014Introduction}, but it is likely the same as equation \eqref{eq:wi_ecl} because both ECL100 and MRST use Peaceman's well model \cite{Lie2014Introduction,Schlumberger2013Eclipse}.

The equivalent wellbore radius for both ECL100 and MRST is by default calculated using the following expression \cite{Schlumberger2013Eclipse,Lie2014Introduction} originally derived by Peaceman \cite{Peaceman1983Interpretation}:
\begin{equation}
    r_{eq} = 0.28 \frac{\sqrt{\Delta x^2 \sqrt{k_y/k_x} + \Delta y^2 \sqrt{k_x/k_y}}}{\sqrt[4]{k_y/k_x}+\sqrt[4]{k_x/k_y}}
\end{equation}
which for isotropic conditions $k_x=k_y$ on a square grid $\Delta x= \Delta y$ reduces to
\begin{equation}
    r_{eq} = 0.1980 \Delta x
\end{equation}
% subsubsection ecl100_implementation (end)

% subsection numerical_reservoir_simulation (end)

% section introduction (end)
